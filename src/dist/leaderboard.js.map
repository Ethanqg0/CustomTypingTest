{
  "version": 3,
  "sources": ["../ts/leaderboard.ts"],
  "sourcesContent": ["interface User {\n  full_name: string;\n  coach?: boolean;\n  best_test: TestRecord;\n  // tests: Array<FilteredTest>;\n}\n\ninterface TestRecord {\n  wpm: number;\n  accuracy: number;\n}\ninterface BestTest {\n  full_name: string;\n  wpm: number;\n  accuracy: number;\n}\n\nfunction rankByWPM(tests: Array<BestTest>) {\n  const test = tests.sort((a, b) => b[\"wpm\"] - a[\"wpm\"]);\n  return test;\n}\n\nfunction filterTests(users: Array<User>) {\n  let filteredTests: Array<BestTest> = [];\n\n  for (const user of users) {\n    if (user[\"coach\"] === true) {\n      continue\n    }\n    let test: TestRecord = user[\"best_test\"]\n    if (!test) continue\n    filteredTests.push(({\n      full_name: user[\"full_name\"],\n      wpm: test[\"wpm\"],\n      accuracy: test[\"accuracy\"],\n    } as BestTest))\n  }\n\n  return filteredTests;\n}\n\n(<any>window).fetchAndDisplayLeaderboard = async () => {\n  console.log(\"Fetching and displaying leaderboard...\")\n  try {\n    const response = await fetch(\n      \"https://tcs-typer.netlify.app/api/leaderboard\"\n      // \"http://localhost:8888/api/leaderboard\"\n    );\n    if (!response) {\n      throw new Error(\"Failed to fetch tests from backend server.\");\n    }\n\n    let tests = await response.json();\n\n    tests = filterTests(tests);\n    tests = rankByWPM(tests);\n\n    const leaderboard = document.querySelector(\n      \".flex-column\"\n    ) as HTMLDivElement;\n    leaderboard.innerHTML = \"\"\n    for (let i: number = 0; i < tests.length; i++) {\n      let player = leaderboard.appendChild(\n        document.createElement(\"div\") as HTMLDivElement\n      );\n      player.classList.add(\"leaderboard-player\");\n\n      let name = player.appendChild(\n        document.createElement(\"h3\") as HTMLHeadingElement\n      );\n\n      name.innerHTML = tests[i][\"full_name\"];\n      if (i === 0) {\n        name.innerHTML += \" \uD83E\uDD47\";\n        name.style.fontWeight = \"600\";\n      } else if (i === 1) {\n        name.innerHTML += \" \uD83E\uDD48\";\n      } else if (i === 2) {\n        name.innerHTML += \" \uD83E\uDD49\";\n      }\n\n      let div = player.appendChild(\n        document.createElement(\"div\") as HTMLDivElement\n      );\n      div.classList.add(\"wpm-accuracy\");\n      let wpm = div.appendChild(\n        document.createElement(\"h4\") as HTMLParagraphElement\n      );\n      wpm.innerHTML = tests[i][\"wpm\"];\n      let accuracy = div.appendChild(\n        document.createElement(\"h4\") as HTMLParagraphElement\n      );\n      accuracy.innerHTML = tests[i][\"accuracy\"] + \"%\";\n    }\n  } catch (error) {\n    console.error(\"An error occurred while fetching the leaderboard: \", error);\n  }\n}\n\nwindow.addEventListener(\"DOMContentLoaded\", async () => {\n  // When the page is loaded, fetch and display the leaderboard\n  if ((<any>window).fetchAndDisplayLeaderboard) {\n    (<any>window).fetchAndDisplayLeaderboard();\n  }\n\n  const leaderboardModal = document.getElementById(\n    \"leaderboard-modal\"\n  ) as HTMLDialogElement;\n  const openModal = document.getElementById(\"leaderboard-toggle\");\n  const closeModal = document.getElementById(\"close-modal\");\n\n  openModal?.addEventListener(\"click\", () => {\n    leaderboardModal.showModal();\n  });\n  leaderboardModal?.addEventListener(\"click\", (e) => {\n    if (e.target !== leaderboardModal) return\n    leaderboardModal.close()\n  })\n  closeModal?.addEventListener(\"click\", () => {\n    leaderboardModal.close();\n  });\n});"],
  "mappings": "8RAAA,IAAAA,EAAAC,EAAAC,GAAA,CAiBA,SAASC,EAAUC,EAAwB,CAEzC,OADaA,EAAM,KAAK,CAAC,EAAGC,IAAMA,EAAE,IAAS,EAAE,GAAM,CAEvD,CAEA,SAASC,EAAYC,EAAoB,CACvC,IAAIC,EAAiC,CAAC,EAEtC,QAAWC,KAAQF,EAAO,CACxB,GAAIE,EAAK,QAAa,GACpB,SAEF,IAAIC,EAAmBD,EAAK,UACvBC,GACLF,EAAc,KAAM,CAClB,UAAWC,EAAK,UAChB,IAAKC,EAAK,IACV,SAAUA,EAAK,QACjB,CAAc,CAChB,CAEA,OAAOF,CACT,CAEM,OAAQ,2BAA6B,IAAYG,EAAAT,EAAA,iBACrD,QAAQ,IAAI,wCAAwC,EACpD,GAAI,CACF,IAAMU,EAAW,MAAM,MACrB,+CAEF,EACA,GAAI,CAACA,EACH,MAAM,IAAI,MAAM,4CAA4C,EAG9D,IAAIR,EAAQ,MAAMQ,EAAS,KAAK,EAEhCR,EAAQE,EAAYF,CAAK,EACzBA,EAAQD,EAAUC,CAAK,EAEvB,IAAMS,EAAc,SAAS,cAC3B,cACF,EACAA,EAAY,UAAY,GACxB,QAASC,EAAY,EAAGA,EAAIV,EAAM,OAAQU,IAAK,CAC7C,IAAIC,EAASF,EAAY,YACvB,SAAS,cAAc,KAAK,CAC9B,EACAE,EAAO,UAAU,IAAI,oBAAoB,EAEzC,IAAIC,EAAOD,EAAO,YAChB,SAAS,cAAc,IAAI,CAC7B,EAEAC,EAAK,UAAYZ,EAAMU,CAAC,EAAE,UACtBA,IAAM,GACRE,EAAK,WAAa,aAClBA,EAAK,MAAM,WAAa,OACfF,IAAM,EACfE,EAAK,WAAa,aACTF,IAAM,IACfE,EAAK,WAAa,cAGpB,IAAIC,EAAMF,EAAO,YACf,SAAS,cAAc,KAAK,CAC9B,EACAE,EAAI,UAAU,IAAI,cAAc,EAChC,IAAIC,EAAMD,EAAI,YACZ,SAAS,cAAc,IAAI,CAC7B,EACAC,EAAI,UAAYd,EAAMU,CAAC,EAAE,IACzB,IAAIK,EAAWF,EAAI,YACjB,SAAS,cAAc,IAAI,CAC7B,EACAE,EAAS,UAAYf,EAAMU,CAAC,EAAE,SAAc,GAC9C,CACF,OAASM,EAAO,CACd,QAAQ,MAAM,qDAAsDA,CAAK,CAC3E,CACF,GAEA,OAAO,iBAAiB,mBAAoB,IAAYT,EAAAT,EAAA,iBAE5C,OAAQ,4BACV,OAAQ,2BAA2B,EAG3C,IAAMmB,EAAmB,SAAS,eAChC,mBACF,EACMC,EAAY,SAAS,eAAe,oBAAoB,EACxDC,EAAa,SAAS,eAAe,aAAa,EAExDD,GAAA,MAAAA,EAAW,iBAAiB,QAAS,IAAM,CACzCD,EAAiB,UAAU,CAC7B,GACAA,GAAA,MAAAA,EAAkB,iBAAiB,QAAUG,GAAM,CAC7CA,EAAE,SAAWH,GACjBA,EAAiB,MAAM,CACzB,GACAE,GAAA,MAAAA,EAAY,iBAAiB,QAAS,IAAM,CAC1CF,EAAiB,MAAM,CACzB,EACF,EAAC",
  "names": ["require_leaderboard", "__commonJSMin", "exports", "rankByWPM", "tests", "b", "filterTests", "users", "filteredTests", "user", "test", "__async", "response", "leaderboard", "i", "player", "name", "div", "wpm", "accuracy", "error", "leaderboardModal", "openModal", "closeModal", "e"]
}
